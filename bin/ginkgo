#!/bin/bash
set -e

GINKGO_VERSION=$(go list -m -f "{{ .Version }}" github.com/onsi/ginkgo/v2)

BIN_DIR="${PWD}/tmp"
BIN_NAME=ginkgo
BIN_PATH="${BIN_DIR}/${BIN_NAME}"

if [ ! -f "${BIN_PATH}" ]
then
  echo "Installing ${BIN_PATH}"
  mkdir -p "${BIN_DIR}"
  GOBIN="${BIN_DIR}" go install github.com/onsi/ginkgo/v2/ginkgo@${GINKGO_VERSION}
fi

exec "${BIN_PATH}" "$@"
